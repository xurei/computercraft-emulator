(function(a){function m(b,c,d,e){var h={data:e||(c?c.data:{}),_wrap:c?c._wrap:null,tmpl:null,parent:c||null,nodes:[],calls:v,nest:w,wrap:x,html:y,update:z};return b&&a.extend(h,b,{nodes:[],parent:c}),d&&(h.tmpl=d,h._ctnt=h._ctnt||h.tmpl(a,h),h.key=++j,(l.length?g:f)[j]=h),h}function o(b,c,e){var f,g=e?a.map(e,function(a){return"string"==typeof a?b.key?a.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g,"$1 "+d+'="'+b.key+'" $2'):a:o(a,b,a._ctnt)}):b;return c?g:(g=g.join(""),g.replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/,function(b,c,d,e){f=a(d).get(),u(f),c&&(f=p(c).concat(f)),e&&(f=f.concat(p(e)))}),f?f:p(g))}function p(b){var c=document.createElement("div");return c.innerHTML=b,a.makeArray(c.childNodes)}function q(b){return Function("jQuery","$item","var $=jQuery,call,_=[],$data=$item.data;with($data){_.push('"+a.trim(b).replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(/\$\{([^\}]*)\}/g,"{{= $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,function(b,c,d,e,f,g,h){var j,k,l,i=a.tmpl.tag[d];if(!i)throw"Template command not found: "+d;return j=i._default||[],g&&!/\w$/.test(f)&&(f+=g,g=""),f?(f=s(f),h=h?","+s(h)+")":g?")":"",k=g?f.indexOf(".")>-1?f+g:"("+f+").call($data"+h:f,l=g?k:"(typeof("+f+")==='function'?("+f+").call($item):("+f+"))"):l=k=j.$1||"null",e=s(e),"');"+i[c?"close":"open"].split("$notnull_1").join(f?"typeof("+f+")!=='undefined' && ("+f+")!=null":"true").split("$1a").join(l).split("$1").join(k).split("$2").join(e?e.replace(/\s*([^\(]+)\s*(\((.*?)\))?/g,function(a,b,c,d){return d=d?","+d+")":c?")":"",d?"("+b+").call($item"+d:a}):j.$2||"")+"_.push('"})+"');}return _;")}function r(b,c){b._wrap=o(b,!0,a.isArray(c)?c:[e.test(c)?c:a(c).html()]).join("")}function s(a){return a?a.replace(/\\'/g,"'").replace(/\\\\/g,"\\"):null}function t(a){var b=document.createElement("div");return b.appendChild(a.cloneNode(!0)),b.innerHTML}function u(b){function p(b){function p(a){a+=c,n=i[a]=i[a]||m(n,f[n.parent.key+c]||n.parent,null,!0)}var e,l,n,o,h=b;if(o=b.getAttribute(d)){for(;h.parentNode&&1===(h=h.parentNode).nodeType&&!(e=h.getAttribute(d)););e!==o&&(h=h.parentNode?11===h.nodeType?0:h.getAttribute(d)||0:0,(n=f[o])||(n=g[o],n=m(n,f[h]||g[h],null,!0),n.key=++j,f[j]=n),k&&p(o)),b.removeAttribute(d)}else k&&(n=a.data(b,"tmplItem"))&&(p(n.key),f[n.key]=n,h=a.data(b.parentNode,"tmplItem"),h=h?h.key:0);if(n){for(l=n;l&&l.key!=h;)l.nodes.push(b),l=l.parent;delete n._ctnt,delete n._wrap,a.data(b,"tmplItem",n)}}var e,h,l,n,o,c="_"+k,i={};for(l=0,n=b.length;n>l;l++)if(1===(e=b[l]).nodeType){for(h=e.getElementsByTagName("*"),o=h.length-1;o>=0;o--)p(h[o]);p(e)}}function v(a,c,d,e){return a?(l.push({_:a,tmpl:c,item:this,data:d,options:e}),b):l.pop()}function w(b,c,d){return a.tmpl(a.template(b),c,d,this)}function x(b,c){var d=b.options||{};return d.wrapped=c,a.tmpl(a.template(b.tmpl),b.data,d,b.item)}function y(b,c){var d=this._wrap;return a.map(a(a.isArray(d)?d.join(""):d).filter(b||"*"),function(a){return c?a.innerText||a.textContent:a.outerHTML||t(a)})}function z(){var b=this.nodes;a.tmpl(null,null,null,this).insertBefore(b[0]),a(b).remove()}var h,c=a.fn.domManip,d="_tmplitem",e=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,f={},g={},i={key:0,data:{}},j=0,k=0,l=[];a.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(b,c){a.fn[b]=function(d){var i,j,l,m,e=[],g=a(d),n=1===this.length&&this[0].parentNode;if(h=f||{},n&&11===n.nodeType&&1===n.childNodes.length&&1===g.length)g[c](this[0]),e=this;else{for(j=0,l=g.length;l>j;j++)k=j,i=(j>0?this.clone(!0):this).get(),a.fn[c].apply(a(g[j]),i),e=e.concat(i);k=0,e=this.pushStack(e,b,g.selector)}return m=h,h=null,a.tmpl.complete(m),e}}),a.fn.extend({tmpl:function(b,c,d){return a.tmpl(this[0],b,c,d)},tmplItem:function(){return a.tmplItem(this[0])},tmplElement:function(){return a.tmplElement(this[0])},template:function(b){return a.template(b,this[0])},domManip:function(b,d,e){if(b[0]&&b[0].nodeType){for(var m,i=a.makeArray(arguments),j=b.length,l=0;j>l&&!(m=a.data(b[l++],"tmplItem")););j>1&&(i[0]=[a.makeArray(b)]),m&&k&&(i[2]=function(b){a.tmpl.afterManip(this,b,e)}),c.apply(this,i)}else c.apply(this,arguments);return k=0,h||a.tmpl.complete(f),this}}),a.extend({tmpl:function(b,c,d,e){var h,j=!e;if(j)e=i,"function"!=typeof b&&(b=a.template[b]||a.template(null,b)),g={};else if(!b)return b=e.tmpl,f[e.key]=e,e.nodes=[],e.wrapped&&r(e,e.wrapped),a(o(e,null,e.tmpl(a,e)));return b?("function"==typeof c&&(c=c.call(e||{})),d&&d.wrapped&&r(d,d.wrapped),h=a.isArray(c)?a.map(c,function(a){return a?m(d,e,b,a):null}):[m(d,e,b,c)],j?a(o(e,null,h)):h):[]},tmplItem:function(b){var c;for(b instanceof a&&(b=b[0]);b&&1===b.nodeType&&!(c=a.data(b,"tmplItem"))&&(b=b.parentNode););return c||i},tmplElement:function(b){for(b instanceof a&&(b=b[0]);b&&1===b.nodeType&&!a.data(b,"tmplItem")&&(b=b.parentNode););return b},template:function(b,c){return c?("string"==typeof c?c=q(c):c instanceof a&&(c=c[0]||{}),c.nodeType&&(c=a.data(c,"tmpl")||a.data(c,"tmpl",q(c.innerHTML))),"string"==typeof b?a.template[b]=c:c):b?"string"!=typeof b?a.template(null,b):a.template[b]||a.template(null,e.test(b)?b:a(b)):null},encode:function(a){return(""+a).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")}}),a.extend(a.tmpl,{tag:{tmpl:{_default:{$2:"null"},open:"if($notnull_1){_=_.concat($item.nest($1,$2));}"},wrap:{_default:{$2:"null"},open:"$item.calls(_,$1,$2);_=[];",close:"call=$item.calls();_=call._.concat($item.wrap(call,_));"},each:{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},"if":{open:"if(($notnull_1) && $1a){",close:"}"},"else":{_default:{$1:"true"},open:"}else if(($notnull_1) && $1a){"},html:{open:"if($notnull_1){_.push($1a);}"},"=":{_default:{$1:"$data"},open:"if($notnull_1){_.push($.encode($1a));}"},"!":{open:""}},complete:function(){f={}},afterManip:function(b,c,d){var e=11===c.nodeType?a.makeArray(c.childNodes):1===c.nodeType?[c]:[];d.call(b,c),u(e),k++}})})(jQuery);
